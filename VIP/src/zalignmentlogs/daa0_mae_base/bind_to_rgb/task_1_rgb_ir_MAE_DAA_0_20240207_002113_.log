2024-02-07 00:21:13,641 - INFO - Configuration:
{
    "task": "1",
    "topic": "",
    "number_gpus": "2",
    "bind_to_rgb": true,
    "modalities": [
        "rgb",
        "ir"
    ],
    "dataset": "DAA",
    "encoder_model": "MAE",
    "split": "0",
    "overfit_on_one_batch": false,
    "num_classes": 34,
    "in_features": 768,
    "epochs": 10,
    "res_cktp": false,
    "cktp_dir": "/home/bas06400/Thesis/VIP/src/align_checkpoints",
    "trained_encoder": [
        "checkpoint_rgb_0_20240124_002637.pth",
        "checkpoint_ir_0_20240126_000105.pth"
    ],
    "learning_rate": 0.0001,
    "gradient_accumulation_steps": 2,
    "scheduler_config": {
        "type": "step",
        "params": {
            "step_size": 4,
            "gamma": 0.1
        }
    },
    "temperature": 0.1,
    "num_workers": 10,
    "data_root": "/net/polaris/storage/deeplearning/ntu",
    "batch_size": 32,
    "random_sample": false,
    "pin_memory": true,
    "clip_config": "openai/clip-vit-base-patch16",
    "clip_weights": "openai/clip-vit-base-patch16",
    "clip_vision_additional_config": {
        "type": "ViP",
        "temporal_size": 12,
        "if_use_temporal_embed": true,
        "logit_scale_init_value": 4.6,
        "add_cls_num": 3
    },
    "e2e_weights_path": "/home/bas06400/Thesis/VIP/src/vidclip_data/output/msrvtt_retrieval/msrvtt_retrieval_vip_base_16/ckpt/old/120CV_B32_model_step_17100.pt"
}
2024-02-07 00:21:13,663 - INFO - Aligning modalities......
2024-02-07 00:21:14,091 - INFO - Training on the following GPUs [2, 3]
2024-02-07 00:21:16,611 - INFO - Checkpoint 'checkpoint_rgb_0_20240124_002637.pth' not found in '/home/bas06400/Thesis/VIP/src/align_checkpoints'.
2024-02-07 00:21:17,757 - INFO - Checkpoint checkpoint_rgb_0_20240124_002637.pth loaded succesfully
2024-02-07 00:21:20,140 - INFO - Checkpoint 'checkpoint_ir_0_20240126_000105.pth' not found in '/home/bas06400/Thesis/VIP/src/align_checkpoints'.
2024-02-07 00:21:20,874 - INFO - Checkpoint checkpoint_ir_0_20240126_000105.pth loaded succesfully
2024-02-07 00:21:21,025 - INFO - Starting training loop
2024-02-07 00:21:21,027 - INFO - Epoch 1/10 - Training
2024-02-07 00:30:04,201 - INFO - Epoch [1/10], modality_0_to_modality_1 Avg Loss: 2.4833
2024-02-07 00:30:04,201 - INFO - Epoch [1/10], Avg Loss: 1.2417
2024-02-07 00:30:04,204 - INFO - Epoch 1/10 - Validation
2024-02-07 00:32:29,510 - INFO - Epoch [1/10], Validation Loss: 3.1361
2024-02-07 00:32:34,394 - INFO - Best val loss 3.136130115720961
2024-02-07 00:32:34,394 - INFO - New best model saved at epoch 1
2024-02-07 00:32:34,398 - INFO - Training statistics saved to /home/bas06400/Thesis/VIP/src/align_checkpoints/checkpoint_rgb_ir_0_20240207_002121
2024-02-07 00:32:34,400 - INFO - Epoch 2/10 - Training
2024-02-07 00:41:09,547 - INFO - Epoch [2/10], modality_0_to_modality_1 Avg Loss: 1.9944
2024-02-07 00:41:09,548 - INFO - Epoch [2/10], Avg Loss: 0.9972
2024-02-07 00:41:09,550 - INFO - Epoch 2/10 - Validation
2024-02-07 00:42:22,224 - INFO - Epoch [2/10], Validation Loss: 3.0534
2024-02-07 00:42:30,773 - INFO - Best val loss 3.0534300751156276
2024-02-07 00:42:30,773 - INFO - New best model saved at epoch 2
2024-02-07 00:42:30,779 - INFO - Training statistics saved to /home/bas06400/Thesis/VIP/src/align_checkpoints/checkpoint_rgb_ir_0_20240207_002121
2024-02-07 00:42:30,782 - INFO - Epoch 3/10 - Training
2024-02-07 00:51:07,172 - INFO - Epoch [3/10], modality_0_to_modality_1 Avg Loss: 1.8739
2024-02-07 00:51:07,172 - INFO - Epoch [3/10], Avg Loss: 0.9369
2024-02-07 00:51:07,174 - INFO - Epoch 3/10 - Validation
2024-02-07 00:52:21,639 - INFO - Epoch [3/10], Validation Loss: 3.0414
2024-02-07 00:52:31,400 - INFO - Best val loss 3.041409402423435
2024-02-07 00:52:31,401 - INFO - New best model saved at epoch 3
2024-02-07 00:52:31,410 - INFO - Training statistics saved to /home/bas06400/Thesis/VIP/src/align_checkpoints/checkpoint_rgb_ir_0_20240207_002121
2024-02-07 00:52:31,415 - INFO - Epoch 4/10 - Training
2024-02-07 01:01:08,693 - INFO - Epoch [4/10], modality_0_to_modality_1 Avg Loss: 1.8019
2024-02-07 01:01:08,694 - INFO - Epoch [4/10], Avg Loss: 0.9009
2024-02-07 01:01:08,697 - INFO - Epoch 4/10 - Validation
2024-02-07 01:02:24,135 - INFO - Epoch [4/10], Validation Loss: 3.0048
2024-02-07 01:02:33,505 - INFO - Best val loss 3.0047993024190265
2024-02-07 01:02:33,505 - INFO - New best model saved at epoch 4
2024-02-07 01:02:33,508 - INFO - Training statistics saved to /home/bas06400/Thesis/VIP/src/align_checkpoints/checkpoint_rgb_ir_0_20240207_002121
2024-02-07 01:02:33,510 - INFO - Epoch 5/10 - Training
2024-02-07 01:11:08,386 - INFO - Epoch [5/10], modality_0_to_modality_1 Avg Loss: 1.7385
2024-02-07 01:11:08,387 - INFO - Epoch [5/10], Avg Loss: 0.8692
2024-02-07 01:11:08,388 - INFO - Epoch 5/10 - Validation
2024-02-07 01:12:22,302 - INFO - Epoch [5/10], Validation Loss: 2.9976
2024-02-07 01:12:31,315 - INFO - Best val loss 2.997585015826755
2024-02-07 01:12:31,315 - INFO - New best model saved at epoch 5
2024-02-07 01:12:31,318 - INFO - Training statistics saved to /home/bas06400/Thesis/VIP/src/align_checkpoints/checkpoint_rgb_ir_0_20240207_002121
2024-02-07 01:12:31,320 - INFO - Epoch 6/10 - Training
2024-02-07 01:21:07,614 - INFO - Epoch [6/10], modality_0_to_modality_1 Avg Loss: 1.7285
2024-02-07 01:21:07,614 - INFO - Epoch [6/10], Avg Loss: 0.8643
2024-02-07 01:21:07,619 - INFO - Epoch 6/10 - Validation
2024-02-07 01:22:23,173 - INFO - Epoch [6/10], Validation Loss: 2.9978
2024-02-07 01:22:23,178 - INFO - Training statistics saved to /home/bas06400/Thesis/VIP/src/align_checkpoints/checkpoint_rgb_ir_0_20240207_002121
2024-02-07 01:22:23,179 - INFO - Epoch 7/10 - Training
2024-02-07 01:31:00,849 - INFO - Epoch [7/10], modality_0_to_modality_1 Avg Loss: 1.7188
2024-02-07 01:31:00,850 - INFO - Epoch [7/10], Avg Loss: 0.8594
2024-02-07 01:31:00,851 - INFO - Epoch 7/10 - Validation
2024-02-07 01:32:13,821 - INFO - Epoch [7/10], Validation Loss: 2.9993
2024-02-07 01:32:13,826 - INFO - Training statistics saved to /home/bas06400/Thesis/VIP/src/align_checkpoints/checkpoint_rgb_ir_0_20240207_002121
2024-02-07 01:32:13,829 - INFO - Epoch 8/10 - Training
2024-02-07 01:40:51,147 - INFO - Epoch [8/10], modality_0_to_modality_1 Avg Loss: 1.7137
2024-02-07 01:40:51,148 - INFO - Epoch [8/10], Avg Loss: 0.8568
2024-02-07 01:40:51,151 - INFO - Epoch 8/10 - Validation
2024-02-07 01:42:04,808 - INFO - Epoch [8/10], Validation Loss: 3.0008
2024-02-07 01:42:04,812 - INFO - Training statistics saved to /home/bas06400/Thesis/VIP/src/align_checkpoints/checkpoint_rgb_ir_0_20240207_002121
2024-02-07 01:42:04,814 - INFO - Epoch 9/10 - Training
2024-02-07 01:50:40,533 - INFO - Epoch [9/10], modality_0_to_modality_1 Avg Loss: 1.7018
2024-02-07 01:50:40,533 - INFO - Epoch [9/10], Avg Loss: 0.8509
2024-02-07 01:50:40,537 - INFO - Epoch 9/10 - Validation
2024-02-07 01:51:53,579 - INFO - Epoch [9/10], Validation Loss: 2.9970
2024-02-07 01:52:03,850 - INFO - Best val loss 2.9969819227854413
2024-02-07 01:52:03,850 - INFO - New best model saved at epoch 9
2024-02-07 01:52:03,857 - INFO - Training statistics saved to /home/bas06400/Thesis/VIP/src/align_checkpoints/checkpoint_rgb_ir_0_20240207_002121
2024-02-07 01:52:03,861 - INFO - Epoch 10/10 - Training
2024-02-07 02:00:38,487 - INFO - Epoch [10/10], modality_0_to_modality_1 Avg Loss: 1.7015
2024-02-07 02:00:38,488 - INFO - Epoch [10/10], Avg Loss: 0.8507
2024-02-07 02:00:38,493 - INFO - Epoch 10/10 - Validation
2024-02-07 02:01:53,921 - INFO - Epoch [10/10], Validation Loss: 2.9969
2024-02-07 02:02:02,626 - INFO - Best val loss 2.9969285594092474
2024-02-07 02:02:02,627 - INFO - New best model saved at epoch 10
2024-02-07 02:02:02,631 - INFO - Training statistics saved to /home/bas06400/Thesis/VIP/src/align_checkpoints/checkpoint_rgb_ir_0_20240207_002121
2024-02-07 02:02:02,631 - INFO - Training complete!
